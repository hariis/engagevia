<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
       "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
  <title>Engaging, one conversation at a time</title>
  <%= stylesheet_link_tag 'post' %>
  <%= javascript_include_tag :defaults %>
  <%= javascript_include_tag "prototype", "effects", "controls" %>
</head>
<body>

<p align="right"><br />
<a href="http://engagevia.r09.railsrumble.com">EngageVia<img src="" alt="" width="414" height="56" border="0" /></a>
</p>
<h1>Engaging, one conversation at a time</h1>
<div id="header-links">
  <ul>
  <% if current_user.activated? %>
    <li><%= link_to 'Home', posts_path if current_user.activated? %></li>
    <li><%= link_to "My Account", edit_user_path(current_user) %> |</li>
    <li><%= link_to "Logout", logout_path %></li>
   <% else %>
     <li><%= link_to "Register", new_user_path %> |</li>
     <li><%= link_to "Login", login_path %> |</li>
     <li><%= link_to "Forgot Password", new_password_reset_path %></li>
   <% end %>
  </ul>
</div>

<p style="color: green"><%= flash[:notice] %></p>

<div id="left">
  <div id="send-status">

  </div>
  <% remote_form_for([@post, @engagement]) do |f| %>
  <%= f.error_messages %>

<fieldset>
  <legend>Invitations</legend>
  <%=  label_tag "Invite by Email" %> 
  <span style="font-size: 8px;">Separate multiple email addresses with a comma. <br/> Limit to 10 at a time. </span>
  <%=  text_area_tag "email_invitees", nil, :cols => '30', :rows => '4' %>

   <%= link_to_function "Send DM to your Twitter followers that are on our email invite list ",
                            visual_effect(:toggle_blind, "get_credentials", :duration => 0.5) %>
  <div id="twitter-invite">>
    <h3>Please Note: DMs are only notifications. Followers should check their email for the link to join the Conversation</h3>
  <div id="twitter_followers">

  </div>

      <%= link_to_function "Show My Followers", visual_effect(:toggle_blind, "get_credentials", :duration => 0.5) %>
        <div id="get_credentials" style="display: none;">
        <h3>Your Twitter Credentials</h3>  <p>
          <%= label_tag 'Twitter Id' %><br />
          <%= text_field_tag :twitter_id %>
        </p>
        <p>
          <%= label_tag 'Twitter Password' %><br />
          <%= password_field_tag :twitter_passwd %>
        </p>
        <%= submit_to_remote 'get_followers', 'Get My Followers',:method => 'get', :url => { :controller => 'posts', :action => 'get_followers' },
                  :before => "Element.toggle( 'get_credentials');"  ,
                  :with => "'twitid='+ escape($('twitter_id').value) + '&twitp=' + escape($('twitter_passwd').value)" %>

               or  <%= link_to_function "Cancel",   visual_effect(:toggle_blind, "get_credentials", :duration => 0.5) %>
        </div>

  </div>


</fieldset>
  <p>
    <%= f.submit 'Send' %>
  </p>
<% end %>
</div>
<div id="right">
  <div id="participants">
    <% unless @post.paticipants.empty? %>
    <ul>
      <% @post.participants.each do |p| %>
      <li>
        <%  p.member? ? p.username : truncate(p.email, p.email.index('@'), "...") %>
      </li>
      <% end %>
    </ul>
    <%  end %>
  </div>
</div>
<div id="content">
<%= yield %>
</div>
</body>
</html>
